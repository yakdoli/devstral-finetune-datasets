```html
<!-- 
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_1380.jpeg
document_name: grid
page_number: 1380
page_id: grid#page_1380
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T05:48:58Z
fidelity: lossless
-->

# Essential Grid for Windows Forms

```vb
filterModel = 
TryCast(Me.gridGroupingControl1.TableModel.CellModels("FilterBarCell"), GridTableCellModel)

Me.gridGroupingControl1.OptimizeFilterPerformance = True
```

```csharp
' In event
private void gridGroupingControl1_TableControlQueryAllowSortColumn(Object sender,
    Syncfusion.Windows.Forms.Grid.Grouping.GridQueryAllowSortColumnEventArgs e)
{
    Dim rowIndex As Integer =
    e.TableControl.Table.Records(0).GetRowIndex()

    Dim colIndex As Integer = e.Column.GetRelativeColumnIndex() + 1 ' Check the col index with your application.

    Dim tableStyleInfo As GridTableCellStyleInfo =
    e.TableControl.GetTableViewStyleInfo(rowIndex, colIndex)

    Dim items() As Object =
    CType(filterModel.GetFilterBarChoices(tableStyleInfo.TableCellIdentity), Object())

    If items.Length = 2 AndAlso items(0).GetType() Is GetType(System.DBNull) Then ' Check if there is only one unique item.
        e.AllowSort = False
    End If
}
```

## 5.4 Common to GridControl, GridDataBoundGrid and GridGrouping

The tasks and solutions discussed in this section apply to either a GridControl or a GridDataBoundGrid.

<!-- tags: [Windows Forms, Essential Grid, GridControl, GridDataBoundGrid, GridGrouping, FilterBarCell, OptimizeFilterPerformance, TableControl, QueryAllowSortColumnEvent, GridQueryAllowSortColumnEventArgs, Syncfusion.Winforms, version: 11.4.0.26] keywords: [filterModel, TryCast, OptimizeFilterPerformance, GridControl, GridDataBoundGrid, GridGrouping, FilterBarCell, TableControl, QueryAllowSortColumnEvent, GridQueryAllowSortColumnEventArgs, rowIndex, colIndex, tableStyleInfo, items, filterModel.GetFilterBarChoices, tableCellIdentity, System.DBNull] -->
```