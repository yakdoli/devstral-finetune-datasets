```html
<!-- 
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_1267.jpeg
document_name: grid
page_number: 1267
page_id: grid#page_1267
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T05:43:05Z
fidelity: lossless
-->

# Essential Grid for Windows Forms

## Overview
- Implements grid customization and behavior in Windows Forms applications.
- Focuses on handling grid cell drawing events and modifying row states based on hierarchy levels.

```vb
[VB.NET]

Private Sub gridDataBoundGrid1_CellDrawn(ByVal sender As Object, ByVal e As Syncfusion.Windows.Forms.Grid.GridDrawCellEventArgs)

    If flag Then
        If e.ColIndex = 0 Then
            ' Retrieve the record state of a row.
            Dim state As GridBoundRecordState = _
            Me.gridDataBoundGrid1.Binder.GetRecordStateAtRowIndex(e.RowIndex)

            count = 0

            ' Check its Hierarchy Level Index.
            If state.LevelIndex = 0 Then

                Me.gridDataBoundGrid1.BeginUpdate()

                Me.gridDataBoundGrid1.Model.SuspendChangeEvents()

                ' To expand the rowIndex for finding the childCount.
                Me.gridDataBoundGrid1.ExpandAtRowIndex(e.RowIndex)

                ' Get the no. of children.
                count = state.ChildCount

                ' To collapse the expanded row.
                Me.gridDataBoundGrid1.CollapseAtRowIndex(e.RowIndex)

                Me.gridDataBoundGrid1.Model.ResumeChangeEvents()

                Me.gridDataBoundGrid1.EndUpdate()

            End If
        End If
    End If
End Sub
```

## API Reference

### Methods
- `BeginUpdate()`
- `Model.SuspendChangeEvents()`
- `ExpandAtRowIndex(rowIndex As Integer)`
- `CollapseAtRowIndex(rowIndex As Integer)`
- `Model.ResumeChangeEvents()`
- `EndUpdate()`

### Events
- `CellDrawn`

## Code Examples

### VB.NET Example
```vb
Private Sub gridDataBoundGrid1_CellDrawn(ByVal sender As Object, ByVal e As Syncfusion.Windows.Forms.Grid.GridDrawCellEventArgs)

    If flag Then
        If e.ColIndex = 0 Then
            Dim state As GridBoundRecordState = _
            Me.gridDataBoundGrid1.Binder.GetRecordStateAtRowIndex(e.RowIndex)

            count = 0

            If state.LevelIndex = 0 Then

                Me.gridDataBoundGrid1.BeginUpdate()

                Me.gridDataBoundGrid1.Model.SuspendChangeEvents()

                Me.gridDataBoundGrid1.ExpandAtRowIndex(e.RowIndex)

                count = state.ChildCount

                Me.gridDataBoundGrid1.CollapseAtRowIndex(e.RowIndex)

                Me.gridDataBoundGrid1.Model.ResumeChangeEvents()

                Me.gridDataBoundGrid1.EndUpdate()

            End If
        End If
    End If
End Sub
```

## Tags and Keywords
<!-- tags: [winforms, grid, cell drawing, hierarchy level, record state, data binding] keywords: [cellDrawn, rowIndex, childCount, gridDrawCellEventArgs, hierarchyIndex, gridBehavior] -->
```