```html
<!-- 
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_1379.jpeg
document_name: grid
page_number: 1379
page_id: grid#page_1379
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T05:50:36Z
fidelity: lossless
-->

# Essential Grid for Windows Forms

## Overview

- Demonstrates how to customize sorting behavior in a `GridGroupingControl` by handling the `TableControl.QueryAllowSortColumn` event.
- Highlights optimization of filter performance and conditions to disable sorting based on filter constraints.

## Content

### Handling Sorting Allowance

In the provided code snippet, the `GridGroupingControl` is configured to optimize filter performance, and an event handler is implemented to customize sorting allowance based on filter conditions.

```csharp
// Optimize filter performance
this.gridGroupingControl1.OptimizeFilterPerformance = true;

// Event handler for querying allowance of sorting a column
private void gridGroupingControl1_TableControlQueryAllowSortColumn(object sender,
    Syncfusion.Windows.Forms.Grid.Grouping.GridQueryAllowSortColumnEventArgs e)
{
    // Get the row and column indices
    int rowIndex = e.TableControl.Table.Records[0].GetRowIndex();
    int colIndex = e.Column.GetRelativeColumnIndex() + 1; // Check the column index with your application.

    // Retrieve the table style information at the given cell
    GridTableCellStyleInfo tableStyleInfo = 
        e.TableControl.GetTableViewStyleInfo(rowIndex, colIndex);

    // Fetch the filter bar choices for the cell
    object[] items = 
        (object[])filterModel.GetFilterBarChoices(tableStyleInfo.TableCellIdentity);

    // Check if the filter has only one unique item
    if (items.Length == 2 && items[0].GetType() == typeof(System.DBNull))
    {
        // Disable sorting if the condition is met
        e.AllowSort = false;
    }
}
```

### Visual Basic Equivalent

```vb
' Declare the filter model globally
Dim filterModel As GridTableFilterBarCellModel = Nothing ' Declare this globally.

' In form load
' The equivalent VB code can be implemented similarly, following the above C# logic.
```

### Explanation

- **OptimizeFilterPerformance**: Enables performance optimizations for filtering operations in the grid.
- **Event Handling**: The `TableControlQueryAllowSortColumn` event is used to determine whether sorting should be allowed for a specific column.
- **Row and Column Identification**: The `GetRowIndex` and `GetRelativeColumnIndex` methods are used to identify the current grid cell, ensuring accurate context for the filter bar choices.
- **Filter Bar Choices**: The `GetFilterBarChoices` method retrieves the possible filter values for the cell, helping to determine if sorting should be allowed based on the uniqueness of the filter items.
- **Sorting Disable Condition**: If the filter has exactly two items and one of them is `DBNull`, sorting is disabled for that column to prevent unnecessary or potentially misleading operations.

## API Reference

### Suggested API References

- **GridGroupingControl.OptimizeFilterPerformance**: Configures whether performance optimizations are applied to filter operations.
- **GridQueryAllowSortColumnEventArgs**: Event arguments used in handling sorting allowance queries.
- **GridTableFilterBarCellModel.GetFilterBarChoices**: Retrieves possible filter values for a given cell based on filter model.
- **GridTableCellStyleInfo**: Represents styling properties for a specific grid cell.

## Code Examples

The provided code examples demonstrate how to implement custom sorting behavior in a `GridGroupingControl` by handling the `TableControl.QueryAllowSortColumn` event and leveraging filter model information to decide whether sorting should be allowed for a column.

## Cross References

- Refer to the `GridGroupingControl` documentation for more details on filter performance optimization and event handling for sorting.
- Additional Syncfusion grid controls may provide similar functionality and can be explored for comparison.

<!-- tags: [GridGroupingControl, filterBar, sorting, eventHandling, filterPerformance] keywords: [queryAllowSortColumn, filterBarChoices, AllowSort, OptimizeFilterPerformance, GridTableCellStyleInfo] -->
```
