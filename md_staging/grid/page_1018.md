```html
<!-- 
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_1018.jpeg
document_name: grid
page_number: 1018
page_id: grid#page_1018
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T05:24:06Z
fidelity: lossless
-->

# Essential Grid for Windows Forms

## Overview
- Implements a custom cell renderer for filter bar cells in a grid control.
- Handles interactions with a list box part in the filter bar.
- Allows applying or clearing filters based on user selection.

## Content

### Custom Filter Cell Renderer

```vb
' Cell Renderer class.
Friend Class CustomFilterCellRenderer : Inherits GridTableFilterBarCellRenderer
    Private filterModel As CustomFilterCellModel

    Public Sub New(ByVal grid As GridControlBase, ByVal cellModel As GridCellModelBase)
        MyBase.New(grid, cellModel)
        filterModel = CType(IIf(TypeOf cellModel Is CustomFilterCellModel, cellModel, Nothing), CustomFilterCellModel)
    End Sub

    Protected Overrides Sub ListBoxMouseUp(ByVal sender As Object, ByVal e As MouseEventArgs)
        Dim tableStyleInfo As GridTableCellStyleInfo = CType(StyleInfo, GridTableCellStyleInfo)
        Dim tableCellIdentity As GridTableCellStyleInfoIdentity = tableStyleInfo.TableCellIdentity
        If Me.ListBoxPart.SelectedIndex = 1 Then
            Dim dlg As FilterDialog = New FilterDialog()
            dlg.colLabel.Text = tableCellIdentity.Column.MappingName
            dlg.SetupOptions(filterModel.FilterBarOptions)
            If dlg.ShowDialog() = DialogResult.OK Then
                ' Apply the filter.
                tableCellIdentity.Table.TableDescriptor.RecordFilters.Add(dlg.FilterString)
            End If
        Else If Me.ListBoxPart.SelectedIndex = 0 Then
            tableCellIdentity.Table.TableDescriptor.RecordFilters.Clear()
        End If
        MyBase.ListBoxMouseUp(sender, e)
    End Sub
End Class
```

### Implementation Steps

1. Create a custom cell renderer class (`CustomFilterCellRenderer`) inheriting from `GridTableFilterBarCellRenderer`.
2. Override the `ListBoxMouseUp` method to handle mouse-up events on the list box part.
3. Depending on the selected index in the list box:
   - If index is `1`, open a `FilterDialog` to apply a filter.
   - If index is `0`, clear existing filters.
4. Pass the necessary model (`filterModel`) to handle filter-related operations.

### Final Step

5. **Replace the default filter bar cell** with the custom filter bar cell by:
   - Registering the new cell model class (`CustomFilterCellModel`) in the existing cell model collection.
   - Assigning the cell type of the `FilterBarCell` to this custom cell type.

## Page-level Navigation/TOC (if applicable)

- **Custom Filter Cell Renderer**
- **Implementation Steps**
- **Final Step**

## API Reference (if applicable)
- **Namespace**: `Syncfusion.Windows.Forms.Grid`
- **Class**: `CustomFilterCellRenderer`
- **Methods**:
  - `New(ByVal grid As GridControlBase, ByVal cellModel As GridCellModelBase)`
  - `ListBoxMouseUp(ByVal sender As Object, ByVal e As MouseEventArgs)`
- **Event Handler**: `FilterDialog.ShowDialog()`

## Code Examples

Sample code snippet for custom filter cell rendering in VB.NET:

```vb
' Custom Filter Cell Renderer
Friend Class CustomFilterCellRenderer : Inherits GridTableFilterBarCellRenderer

    ' Custom Filter Model
    Private filterModel As CustomFilterCellModel

    ' Constructor
    Public Sub New(ByVal grid As GridControlBase, ByVal cellModel As GridCellModelBase)
        MyBase.New(grid, cellModel)
        filterModel = CType(IIf(TypeOf cellModel Is CustomFilterCellModel, cellModel, Nothing), CustomFilterCellModel)
    End Sub

    ' Handle ListBox Mouse Up Event
    Protected Overrides Sub ListBoxMouseUp(ByVal sender As Object, ByVal e As MouseEventArgs)
        Dim tableStyleInfo As GridTableCellStyleInfo = CType(StyleInfo, GridTableCellStyleInfo)
        Dim tableCellIdentity As GridTableCellStyleInfoIdentity = tableStyleInfo.TableCellIdentity

        If Me.ListBoxPart.SelectedIndex = 1 Then
            Dim dlg As FilterDialog = New FilterDialog()
            dlg.colLabel.Text = tableCellIdentity.Column.MappingName
            dlg.SetupOptions(filterModel.FilterBarOptions)

            If dlg.ShowDialog() = DialogResult.OK Then
                tableCellIdentity.Table.TableDescriptor.RecordFilters.Add(dlg.FilterString)
            End If
        Else If Me.ListBoxPart.SelectedIndex = 0 Then
            tableCellIdentity.Table.TableDescriptor.RecordFilters.Clear()
        End If

        MyBase.ListBoxMouseUp(sender, e)
    End Sub
End Class
```

## RAG Annotations

<!-- tags: [grid, filterbar, customcellrenderer, cellmodel, windowsforms] keywords: [custom filter cell, renderer, gridtablefilterbarcellrenderer, listboxmouseup, filterdialog, filterstring] -->
```