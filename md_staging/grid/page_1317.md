```html
<!--
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_1317.jpeg
document_name: grid
page_number: 1317
page_id: grid#page_1317
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T05:46:07Z
fidelity: lossless
-->

# Essential Grid for Windows Forms

Through the nested table's `ParentRecord.GetValue()` method, the value of the parent record of the nested table can be retrieved when we are in the nested table. In the `QueryCellStyleInfo` event, the parent record's value is retrieved as an object. With the object, the data sources of the nested tables are changed. The code for the `QueryCellStyleInfo` event is as follows.

## QueryCellStyleInfo Event Implementation

### C#

```csharp
private void gridGroupingControl1_QueryCellStyleInfo(object sender, GridTableCellStyleInfoEventArgs e)
{
    if (e.TableCellIdentity.Column != null &&
        e.TableCellIdentity.Column.MappingName == "dropCol" &&
        e.TableCellIdentity.DisplayElement is GridRecordRow)
    {
        object o = 
            e.TableCellIdentity.DisplayElement.ParentChildTable.ParentNestedTable.ParentRecord.GetValue("check");
        this.gridGroupingControl1.TableModel.ResetVolatileData();
        if (o != System.DBNull.Value && o != null && (bool)o)
        {
            e.Style.DataSource = colors;
            e.Style.DisplayMember = "color";
            e.Style.ValueMember = "color";
            e.Style.CellType = "GridListControl";
        }
        else
        {
            e.Style.DataSource = shapes;
            e.Style.DisplayMember = "shape";
            e.Style.ValueMember = "shape";
            e.Style.CellType = "GridListControl";
        }
    }
}
```

### VB

```vb
Private Sub gridGroupingControl1_QueryCellStyleInfo(ByVal sender As Object, ByVal e As GridTableCellStyleInfoEventArgs)
    If Not e.TableCellIdentity.Column Is Nothing AndAlso
        e.TableCellIdentity.Column.MappingName = "dropCol" AndAlso TypeOf 
        e.TableCellIdentity.DisplayElement Is GridRecordRow Then
        Dim o As Object = 
            e.TableCellIdentity.DisplayElement.ParentChildTable.ParentNestedTable.ParentRecord.GetValue("check")
        Me.gridGroupingControl1.TableModel.ResetVolatileData()
        If Not o Is System.DBNull.Value AndAlso Not o Is Nothing Then
        End If
    End If
End Sub
```

### Explanation

- **`ParentRecord.GetValue("check")`**: Retrieves the value of the specified property (`"check"`) from the parent record of the nested table.
- **`ResetVolatileData()`**: Ensures that any volatile (temporary) data in the table model is refreshed, so the changes take effect.
- **`GridListControl`**: The cell type is set to `GridListControl` to display a dropdown list.
- **Conditional Logic**: Based on the value retrieved from the parent record, the data source (`colors` or `shapes`) is dynamically assigned to the dropdown list.

### Purpose

This implementation dynamically changes the data source displayed in a dropdown list (`GridListControl`) within a nested table, based on the value of a property in the parent record. This is particularly useful for scenarios where the options available in a child table depend on the state or data of its parent record.

## API Reference

### Methods
- **`ParentRecord.GetValue(string)`**: Retrieves the value of the specified property from the parent record.
- **`TableModel.ResetVolatileData()`**: Resets any volatile data in the table model.

## Code Examples

The provided code examples demonstrate how to use the `QueryCellStyleInfo` event to dynamically change the data source for dropdown lists in nested tables based on the value of the parent record.

```markdown
### Key Points
- The `ParentRecord.GetValue()` method is used to retrieve the value of the parent record.
- The `ResetVolatileData()` method ensures the changes are applied to the table model.
- The `GridListControl` is configured with a dynamic data source depending on the parent record's value.

### Notes
- Ensure that the data sources (`colors` and `shapes`) are properly defined and assigned before use.
- The `dropCol` column is specifically targeted for this dynamic behavior.
```

### Optional Documentation Links

- [Syncfusion Grid Documentation](https://help.syncfusion.com/windowsforms/grid/overview)
- [Grid QueryCellStyleInfo Event](https://help.syncfusion.com/windowsforms/grid/cell-style#querycellstyle-event)
- [Grid Nested Tables](https://help.syncfusion.com/windowsforms/grid/nested-tables)
- [GridListControl Overview](https://help.syncfusion.com/windowsforms/gridlistcontrol/overview)

<!-- tags: [syncfusion, windowsforms, grid, nested tables, cell styling, QueryCellStyleInfo, GridListControl, data source, parent record, nested tables] keywords: [nested tables, cell styling, dynamic data source, GridListControl, parent record, QueryCellStyleInfo, dropdown list, data source assignment] -->
``` 
