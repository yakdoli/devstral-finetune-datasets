```html
<!-- 
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_1274.jpeg
document_name: grid
page_number: 1274
page_id: grid#page_1274
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T05:43:44Z
fidelity: lossless
-->

# Essential Grid for Windows Forms

## Overview
- This section explains how to implement tri-state sorting in a GridDataBoundGridControl.
- It discusses the use of the CellClick event to toggle sorting orders and handle unsorting.
- The solution involves customizing the Tag property of columns to store sorting state.

## Content

### 5.2.22 How to Support Tri-State Sorting in a GridDataBoundGridControl

#### Introduction

The standard sorting in a GridDataBoundGridControl does not remove the sorting from a column once it is sorted. It remains either in ascending or descending order. By utilizing the GridDataBoundGridControl's `CellClick` event, it is possible to modify this behavior so that:

1. A column is sorted in ascending order on the first click.
2. On the second click, the column is sorted in descending order.
3. On the third click, the sorting is removed.

This tri-state sort behavior is achieved by storing the sort indicator in the `Tag` property of the column and handling the `CellClick` event. When a column is clicked, it examines the current `Tag` value to determine the next sorting action.

#### Implementation Challenges

There are a few challenges to address:
- The standard column header cell uses the `Tag` property for its "sort order" indicator and explicitly sets the non-sorted header's `Tag` to indicate either ascending or descending. This does not inherently support an "unsorted" state.
- To workaround this, the HeaderCell must be hidden and a new HeaderCell must be added.

#### Example

The following C# code demonstrates how to implement tri-state sorting:

```csharp
[C#]

// Set Datasource.
this.gridDataBoundGrid1.DataSource = dt;
this.gridDataBoundGrid1.Model.BaseStylesMap["Column Header"].StyleInfo.CellType = "Header";
this.gridDataBoundGrid1.Model.Data.RowCount = 1;
this.gridDataBoundGrid1.Model.Rows.HeaderCount = 1;
this.gridDataBoundGrid1.Model.Rows.FrozenCount = 1;

// Hide the Column Header Cells.
this.gridDataBoundGrid1.Model.HideRows[0] = true;

// Add New Header Cells.
for(int col = 1; col <= 3; ++col)
{
    this.gridDataBoundGrid1[1, col] = this.gridDataBoundGrid1[0,1];
    this.gridDataBoundGrid1[1, col].CellType = "ColumnHeaderCell";
}
```

## API Reference
- `GridDataBoundGrid`
- `CellClick` event
- `BaseStylesMap`
- `HeaderCount`
- `FrozenCount`
- `HideRows`
- `CellType`

## Code Examples

The example provided demonstrates setting up a GridDataBoundGridControl with a custom header row to enable tri-state sorting. By hiding the standard header row and adding custom header cells, it is possible to manage the sorting state manually using the `Tag` property.

## Cross References
- For detailed documentation on GridDataBoundGridControl, refer to the Syncfusion Windows Forms User Guide.

<!-- tags: Windows Forms, GridDataBoundGrid, tri-state sorting, CellClick event, Tag property, HeaderCell, BaseStylesMap, HeaderCount, FrozenCount, HideRows, CellType -->
```
