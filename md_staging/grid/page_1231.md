```html
<!--
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_1231.jpeg
document_name: grid
page_number: 1231
page_id: grid#page_1231
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T05:38:23Z
fidelity: lossless
-->

## Content

### Event Handling for Grid Selection Changes

In the following sections, we demonstrate how to handle grid selection changes and synchronize the selections between two grids. This is useful in scenarios where you want to maintain identical selections across multiple grid controls.

#### Handling Selection Changes in C#

The C# code snippet below shows how to handle the `SelectionChanged` event and synchronize the selections between `sourceGrid` and `targetGrid`.

```csharp
sourceGrid, GridSelectionChangedEventArgs e)
{
    int sourceCount = sourceGrid.Selections.Ranges.Count;
    int targetCount = targetGrid.Selections.Ranges.Count;
    int maxCount = Math.Max(sourceCount, targetCount);

    // Invalidate any ranges that were changed.
    for (int n = 0; n < maxCount; n++)
    {
        GridRangeInfo newRange = n < sourceCount ?
            sourceGrid.Selections.Ranges[n] : GridRangeInfo.Empty;
        GridRangeInfo oldRange = n < targetCount ?
            targetGrid.Selections.Ranges[n] : GridRangeInfo.Empty;
        if (!oldRange.Equals(newRange))
        {
            Console.WriteLine("{0} - {1}", oldRange, newRange);
            targetGrid.InvalidateRange(oldRange);
            targetGrid.InvalidateRange(newRange);
        }
    }
}
// Update underlying data structure - does not cause invalidate / paint
...
targetGrid.Selections.Ranges.Clear();
GridRangeInfo[] ranges = new GridRangeInfo[sourceCount];
sourceGrid.Selections.Ranges.CopyTo(ranges, 0);
targetGrid.Selections.Ranges.AddRange(ranges);
}
```

#### Handling Selection Changes in VB.NET

The VB.NET code snippet below shows the equivalent functionality for synchronizing grid selections.

```vb
Sub gridControl1_SelectionChanged(ByVal sender As Object, ByVal e As GridSelectionChangedEventArgs)
    Synchronize_SelectionChanged(gridControl2, gridControl1, e)
End Sub 'gridControl1_SelectionChanged

Sub gridControl2_SelectionChanged(ByVal sender As Object, ByVal e As GridSelectionChangedEventArgs)
    Synchronize_SelectionChanged(gridControl1, gridControl2, e)
End Sub 'gridControl2_SelectionChanged

Sub Synchronize_SelectionChanged(ByVal targetGrid As GridControl, ByVal sourceGrid As GridControl, ByVal e As GridSelectionChangedEventArgs)
    Dim sourceCount As Integer = sourceGrid.Selections.Ranges.Count
    Dim targetCount As Integer = targetGrid.Selections.Ranges.Count
    Dim maxCount As Integer = Math.Max(sourceCount, targetCount)
```

### Synchronization Logic

The synchronization logic involves the following steps:

1. **Count the Selections**: Determine the number of selected ranges in both the source and target grids.
2. **Compare Ranges**: For each range in the grids, check if the selection has changed.
3. **Invalidate Ranges**: If a change is detected, invalidate the corresponding ranges in the target grid to reflect the updates.
4. **Update Selections**: Copy the new selection ranges from the source grid to the target grid to ensure synchronization.

This approach ensures that any changes in the selection of one grid are quickly and accurately reflected in the other grid.

### Additional Notes

- **Performance Consideration**: Invalidate operations can affect performance, especially with large grids. Ensure that invalidation is minimized to optimize performance.
- **Event Handling**: Ensure that the `SelectionChanged` event is properly wired for both grids to capture changes.

## API Reference

### Classes and Methods Used

- **GridControl**: Represents the grid control.
- **Selections**: Provides access to the grid's selection management capabilities.
- **Ranges**: Represents a collection of grid ranges.
- **GridRangeInfo**: Represents a range in a grid.
- **InvalidateRange**: Invalidates a specified range in the grid.
- **Math.Max**: Determines the maximum of two integers.
- **Console.WriteLine**: Outputs text to the console for debugging purposes.
- **SelectionChangedEventArgs**: Arguments related to the selection changed event.

### Parameters

- **sourceGrid**: The grid control where the selection change originated.
- **targetGrid**: The grid control where the selection changes need to be synchronized.
- **e**: Contains event data related to the selection change.

## Code Examples

### C# Example

```csharp
public void SyncGrids(sourceGrid, targetGrid)
{
    int sourceCount = sourceGrid.Selections.Ranges.Count;
    int targetCount = targetGrid.Selections.Ranges.Count;
    int maxCount = Math.Max(sourceCount, targetCount);

    for (int n = 0; n < maxCount; n++)
    {
        GridRangeInfo newRange = n < sourceCount ?
            sourceGrid.Selections.Ranges[n] : GridRangeInfo.Empty;
        GridRangeInfo oldRange = n < targetCount ?
            targetGrid.Selections.Ranges[n] : GridRangeInfo.Empty;
        if (!oldRange.Equals(newRange))
        {
            Console.WriteLine("{0} - {1}", oldRange, newRange);
            targetGrid.InvalidateRange(oldRange);
            targetGrid.InvalidateRange(newRange);
        }
    }
    // Update target grid selections
    targetGrid.Selections.Ranges.Clear();
    GridRangeInfo[] ranges = new GridRangeInfo[sourceCount];
    sourceGrid.Selections.Ranges.CopyTo(ranges, 0);
    targetGrid.Selections.Ranges.AddRange(ranges);
}
```

### VB.NET Example

```vb
Sub SyncGrids(ByVal sourceGrid As GridControl, ByVal targetGrid As GridControl)
    Dim sourceCount As Integer = sourceGrid.Selections.Ranges.Count
    Dim targetCount As Integer = targetGrid.Selections.Ranges.Count
    Dim maxCount As Integer = Math.Max(sourceCount, targetCount)

    For n As Integer = 0 To maxCount - 1
        Dim newRange As GridRangeInfo = If(n < sourceCount, sourceGrid.Selections.Ranges(n), GridRangeInfo.Empty)
        Dim oldRange As GridRangeInfo = If(n < targetCount, targetGrid.Selections.Ranges(n), GridRangeInfo.Empty)
        If Not oldRange.Equals(newRange) Then
            Console.WriteLine("{0} - {1}", oldRange, newRange)
            targetGrid.InvalidateRange(oldRange)
            targetGrid.InvalidateRange(newRange)
        End If
    Next
    ' Update target grid selections
    targetGrid.Selections.Ranges.Clear()
    Dim ranges() As GridRangeInfo = New GridRangeInfo(sourceCount - 1) {}
    sourceGrid.Selections.Ranges.CopyTo(ranges, 0)
    targetGrid.Selections.Ranges.AddRange(ranges)
End Sub
```

### Cross References

For more information on grid controls and selection management, refer to the following sections:
- **Binding Grids**: Learn how to bind data sources to grid controls.
- **Customizing Grid Appearance**: Explore options for customizing the appearance of grid controls.

## RAG Annotations

<!-- tags: [syncfusion, windows forms, grid, selection synchronization, gridcontrol, selectionchangedeventargs, gridrangeinfo, invalidate, math, selection management] keywords: [sourceGrid, targetGrid, selections, ranges, selectionChanges, eventHandling, selectionSynchronization, invalidateRange, mathMax, consoleWriteLine] -->
```