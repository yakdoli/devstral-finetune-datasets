```html

<!--
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_1270.jpeg
document_name: grid
page_number: 1270
page_id: grid#page_1270
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T05:43:21Z
fidelity: lossless
-->

## Overview
- Explains how to convert and display cell values as percentages in grid cells using `GridQueryCellFormattedText` and `GridSaveCellFormattedText` events.
- Demonstrates retrieving the `DataRow` from the `GridDataBoundGrid` using `RowIndex` and `CurrencyManager`.

## Content

### Code Example: Formatting and Converting Cell Values in VB.NET

```vb
' VB.NET
Private Sub Model_QueryCellFormattedText(ByVal sender As Object, ByVal e As Syncfusion.Windows.Forms.Grid.GridCellTextEventArgs)
    If e.Style.CellValueType Is GetType(Double) AndAlso e.Style.Text.Length > 0 Then
        ' Convert the cell value to percentage for display.
        Dim dVal As Double = CDbl(e.Style.CellValue) / 500 * 100
        e.Text = dVal.ToString("#.##")
        e.Handled = True
    End If
End Sub

Private Sub Model_SaveCellFormattedText(ByVal sender As Object, ByVal e As Syncfusion.Windows.Forms.Grid.GridCellTextEventArgs)
    If e.Style.CellValueType Is GetType(Double) AndAlso e.Style.Text.Length > 0 Then
        ' Convert the Cell Value again from percentage to its original format.
        Dim dVal As Double = Double.Parse(e.Text) / 100 * 500

        ' Save the converted cell value.
        e.Style.CellValue = dVal
        e.Handled = True
    End If
End Sub
```

### 5.2.18 How to Retrieve the DataRow from the GridDataBoundGrid with the RowIndex

#### Introduction
The `GridDataBoundGrid` is bound to the datasource using the `CurrencyManager`. Using the `CurrencyManager`, the record corresponding to the row index can be retrieved.

---

## API Reference

### Events
- **GridQueryCellFormattedText**
  - *Description*: Triggered to retrieve text for a grid cell when the cell is in a query mode.
  - *Parameters*:
    - `sender`: The object that triggered the event.
    - `e`: The event arguments containing the cell formatting details.
  - *Usage*: Handles the formatting displayed to the user for a cell.

- **GridSaveCellFormattedText**
  - *Description*: Triggered to update the value of a grid cell when the text is saved.
  - *Parameters*:
    - `sender`: The object that triggered the event.
    - `e`: The event arguments containing the cell formatting details.
  - *Usage*: Handles the conversion of displayed text back to the original value format.

### Classes
- **CurrencyManager**
  - *Description*: Manages the binding between a grid and the underlying data source.
  - *Usage*: Retrieves the correct `DataRow` corresponding to a specific `RowIndex`.

---

## Code Examples

### Example: Retrieving DataRow from GridDataBoundGrid

```vb
' Example demonstrating how to retrieve DataRow using CurrencyManager
Dim grid As Syncfusion.Windows.Forms.GridDataBoundGrid
Dim rowIndex As Integer
Dim currencyManager As CurrencyManager = CType(grid.BindingContext(grid.DataSource), CurrencyManager)

Dim rowPosition As Integer = rowIndex
Dim dataRow As DataRow

If Not grid.DataSource Is Nothing Then
    Try
        currencyManager.Position = rowPosition
        dataRow = CType(currencyManager.Current, DataRowView).Row
    Catch ex As Exception
        ' Handle exception if needed
    End Try
End If

' Now 'dataRow' contains the DataRow corresponding to the specified row index.
```

---

### See also:
- **GridDataBoundGrid**
- **CurrencyManager**
- **GridQueryCellFormattedText**
- **GridSaveCellFormattedText**

---

<!-- tags: [Syncfusion, Winforms, Grid, GridDataBoundGrid, CurrencyManager, GridQueryCellFormattedText, GridSaveCellFormattedText, DataRow, RowIndex] keywords: [percentage formatting, cell value conversion, data retrieval, record management, grid data binding, row index] -->
```