```html
<!--
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_1372.jpeg
document_name: grid
page_number: 1372
page_id: grid#page_1372
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T05:51:10Z
fidelity: lossless
-->

# Essential Grid for Windows Forms

In the above codes, `IComparer` is used to compare the groups to move. If X1 is greater than the Y1 groups, it will return either X1 or Y1. This Comparer class is used to move all groups from their original position. `sortColumnDescriptorName` describes the grouped column.

## Handling the QueryValue Event

The `QueryValue` event is handled to make the grid use the custom `Comparer`.

### Event Handler: gridGroupingControl1_QueryValue

```csharp
void gridGroupingControl1_QueryValue(object sender, FieldValueEventArgs e)
{
    //Code...
    if (g == e.Record.ParentGroup)
    {
        ArrayList list = new ArrayList(table.Values.Count);
        list.AddRange(table.Values);
        list.Sort();
        if (flag1 || flag2)
        {
            if (flag1)
            {
                index = list.IndexOf(table[e.Record.GetValue(e.TableDescriptor.GroupedColumns[0].Name)]) - 1;
            }
            else if (flag2)
            {
                index = list.IndexOf(table[e.Record.GetValue(e.TableDescriptor.GroupedColumns[0].Name)]) + 1;
            }
            if (index < 0 || index >= list.Count)
            {
                MessageBox.Show("Cannot go further!");
            }
        }
        //Code...
    }
}
```

#### Moving Records

- **Move Up**: If you click the Move Up button, the index of the current record is decreased using the following code:

  ```csharp
  index = list.IndexOf(table[e.Record.GetValue(e.TableDescriptor.GroupedColumns[0].Name)]) - 1;
  ```

- **Move Down**: If you click the Move Down button, then the index of the current record is increased. Refer to the following code:

  ```csharp
  index = list.IndexOf(table[e.Record.GetValue(e.TableDescriptor.GroupedColumns[0].Name)]) - 1;
  ```

### Code Example

```csharp
//Code...
}
}
```

---

<!-- tags: [syncfusion-windows-forms, grid, queryvalue, comparer, moverecords] keywords: [grid, queryvalue, comparer, move up, move down, grouped columns, index, table, records] -->
```