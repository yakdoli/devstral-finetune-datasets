```html
<!--
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_1287.jpeg
document_name: grid
page_number: 1287
page_id: grid#page_1287
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T05:43:37Z
fidelity: lossless
-->

# Essential Grid for Windows Forms

## Overview
- Demonstrates sorting data in a `GridDataBoundGrid` using a `CellClick` event.
- Explains how to apply filtering on the `GridDataBoundGrid` based on a node selected in a `TreeView`.

## Content

### Cell Click Sorting

The following Visual Basic (VB) code snippet shows how to sort data in a `GridDataBoundGrid` when a cell is clicked.

```vb
Private Sub gridDataBoundGrid1_CellClick(ByVal sender As Object, ByVal e As GridCellClickEventArgs)
    If e.RowIndex = 0 AndAlso e.ColIndex > 0 Then
        Dim filed As Integer = Me.gridDataBoundGrid1.Binder.ColIndexToField(e.ColIndex)
        Dim name As String = Me.gridDataBoundGrid1.Binder.InternalColumns(filed).MappingName
        Dim lw As WrapperClass = TryCast(Me.gridDataBoundGrid1.DataSource, WrapperClass)
        lw.Sort(name, True)
        e.Cancel = True
        Me.gridDataBoundGrid1.Refresh()
    End If
End Sub
```

This code sorts the grid data based on the column clicked, where the first row is the header row.

### Filtering Based on Tree View Selection

#### Application of Filtering on the GridDataBound Grid based on a Node Selected in the Tree View

The `GridDataBound` grid is designed as a grid to bind data sources such as data table, string collection, data set, and data view. The filter bar can be enabled or hidden in the grid. Before selecting a node in the Tree view, the grid will load all the data from the data source. The `TreeView_AfterSelect` event is used to determine the tree view node and perform filter operations on the grid control corresponding to the node that you selected in the Tree view.

The following code example illustrates how to apply filtering on the `GridDataBound` grid based on a node selected in the Tree view.

```csharp
// Include the below four lines of code in the constructor

treeViewAdv1.ExpandAll();
filter = new GridFilterBar();
// Associates Grid with the filter
filter.WireGrid(this.gridDataBoundGrid1);
// Hide the filter bar row
this.gridDataBoundGrid1.Model.Rows.Hidden[1] = true;
```

This code hides the filter bar row by default and associates the `GridDataBoundGrid` with the `GridFilterBar`, enabling filtering functionality based on the selected node in the Tree view.

## API Reference

### Methods
- `gridDataBoundGrid1_CellClick`: Handles the cell click event in the grid.
- `ColIndexToField`: Converts column index to field name.
- `InternalColumns`: Retrieves internal column mapping information.
- `Sort`: Applies sorting to the data source.
- `TryCast`: Attempts to cast an object to a specified type.
- `Refresh`: Refreshes the grid to update its display.
- `TreeViewAdv1.ExpandAll`: Expands all nodes in the `TreeViewAdv`.
- `GridFilterBar`: Represents a filtering interface for the grid.
- `WireGrid`: Associates the filter bar with the grid.
- `Rows.Hidden`: Hides specified rows in the grid.

## Code Examples

### VB Code Example for Sorting
```vb
Private Sub gridDataBoundGrid1_CellClick(ByVal sender As Object, ByVal e As GridCellClickEventArgs)
    If e.RowIndex = 0 AndAlso e.ColIndex > 0 Then
        Dim filed As Integer = Me.gridDataBoundGrid1.Binder.ColIndexToField(e.ColIndex)
        Dim name As String = Me.gridDataBoundGrid1.Binder.InternalColumns(filed).MappingName
        Dim lw As WrapperClass = TryCast(Me.gridDataBoundGrid1.DataSource, WrapperClass)
        lw.Sort(name, True)
        e.Cancel = True
        Me.gridDataBoundGrid1.Refresh()
    End If
End Sub
```

### C# Code Example for Filtering
```csharp
treeViewAdv1.ExpandAll();
filter = new GridFilterBar();
filter.WireGrid(this.gridDataBoundGrid1);
this.gridDataBoundGrid1.Model.Rows.Hidden[1] = true;
```

## Cross References

- **See also:**
  - `GridDataBoundGrid` for more details on the grid.
  - `GridFilterBar` for filtering functionality.
  - `TreeViewAdv` for details on the Tree View control.

<!-- tags: [Syncfusion, Windows Forms, GridDataBoundGrid, Filtering, TreeView, Sorting, WinForms] keywords: [cell click, sorting, filter bar, datasource, wrappedclass, griddataboundgrid, treenode, treestate, data table, string collection, data set, data view] -->
```