```html
<!-- 
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_1450.jpeg
document_name: grid
page_number: 1450
page_id: grid#page_1450
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T05:56:25Z
fidelity: lossless
-->

# Essential Grid for Windows Forms

## Overview
- Describes how to work with user-defined functions in Excel using the Syncfusion Essential Grid for Windows Forms.
- Demonstrates the use of the VBA editor to add custom functions.
- Explains how to export these functions to Excel.

## Content

### Working with User-Defined Functions in Excel

#### Visual Basic for Applications (VBA) Setup
The screenshot shows the **Microsoft Visual Basic for Applications** interface opened for editing an XLA (Excel Add-in) file. The interface includes:

- **Project Explorer**: Lists the project structure, including Microsoft Excel Objects (`Sheet1`, `ThisWorkbook`).
- **Properties Window**: Displays properties for `Sheet1`.
- **Code Editor**: Contains a user-defined function named `Age` that calculates age based on a date of birth.

Here is the user-defined function shown in the code editor:
```vb
Function Age(Dob As Date)
    If Dob = 0 Then
        Age = ""
    Else
        Age = Int((Date - Dob) / 365.25)
    End If
End Function
```

#### Notes on XLA Files
- The `.XLA` file will not be visible in Excel because Add-Ins are never visible.
- All changes must be made within the VBA Editor.

#### Exporting User-Defined Functions
The following steps illustrate how to export the user-defined function to Excel using C#:

1. **C# Code Example**:
   ```csharp
   // Exporting the user-defined function.
   string xla = @"..\..\AddIns>Add.xla";
   Syncfusion.GridExcelConverter.GridExcelConverterControl gecc = new
   Syncfusion.GridExcelConverter.GridExcelConverterControl();
   gecc.AddCustomFunction(xla, "add", saveFileDialog1.FileName);
   gecc.GridToExcel(this.gridControl1.Model, saveFileDialog1.FileName);
   ```

### Key Points
- **XLA File Visibility**: Add-Ins are not visible in Excel; all modifications are done in the VBA Editor.
- **Function Export**: The C# code snippet demonstrates exporting a custom function from the grid control to an Excel file using the `Syncfusion.GridExcelConverter` class.

## API Reference

### Namespaces and Classes
- `Syncfusion.ExcelConverter.GridExcelConverterControl`
- `Syncfusion.ExcelConverter`

### Methods
- `AddCustomFunction(string xla, string functionName, string fileName)`
  - **Purpose**: Adds a custom function to the Excel file.
  - **Parameters**:
    - `xla`: Path to the XLA file.
    - `functionName`: Name of the custom function to add.
    - `fileName`: Path to the destination Excel file.
  - **Returns**: None.

- `GridToExcel(object model, string fileName)`
  - **Purpose**: Converts the grid model to an Excel file.
  - **Parameters**:
    - `model`: The grid model to be exported.
    - `fileName`: Path to the destination Excel file.
  - **Returns**: None.

### Parameters
- `xla`: Path to the XLA file.
- `functionName`: Name of the user-defined function.
- `fileName`: Path to the Excel file where the function will be exported.

## Code Examples

### Exporting to Excel
Below is a complete example in C# showing how to export a user-defined function to an Excel file:

```csharp
// Path to the XLA file.
string xlaPath = @"..\..\AddIns>Add.xla";

// Path where the Excel file will be saved.
string excelFilePath = saveFileDialog1.FileName;

// Initialize GridExcelConverterControl.
Syncfusion.GridExcelConverter.GridExcelConverterControl gecc = new
Syncfusion.GridExcelConverter.GridExcelConverterControl();

// Add the custom function to the Excel file.
gecc.AddCustomFunction(xlaPath, "add", excelFilePath);

// Convert the grid model to Excel.
gecc.GridToExcel(this.gridControl1.Model, excelFilePath);
```

## Summary
This page explains how to use the Syncfusion Essential Grid for Windows Forms to create and export user-defined functions to Excel using the VBA editor and the `GridExcelConverterControl` class in C#. All changes to the XLA file are made in the VBA Editor, and the provided C# code demonstrates the process of exporting these functions.

<!-- tags: [Syncfusion Winforms, Essential Grid, Excel Integration, User-Defined Functions, VBA Editor, GridExcelConverterControl] keywords: [XLA, Add-Ins, Export, Custom Functions, VBA, User-defined functions] -->
```