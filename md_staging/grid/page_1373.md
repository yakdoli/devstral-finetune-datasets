```html
<!-- 
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_1373.jpeg
document_name: grid
page_number: 1373
page_id: grid#page_1373
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T05:48:11Z
fidelity: lossless
-->

## **Essential Grid for Windows Forms**

### Implementation of Custom Group Sort Order Comparer

#### Overview
- Implements a custom comparer for sorting groups in a GridGroupingControl.
- Uses `IComparer` to compare groups for sorting.
- The `sortColumnDescriptorName` specifies the column on which grouping is based.

#### Content

```vb
[VB]
public class CustomGroupSortOrderComparer : IGroupSortOrderComparer
    Dim sortColumnDescriptorName As String
    public CustomGroupSortOrderComparer(String sortColumnDescriptorName)
        Me.sortColumnDescriptorName = sortColumnDescriptorName
    'Region "IComparer Members"
    public Integer Compare(Object x, Object y)
        Dim xl As Group = TryCast(x, Group)
        Dim y1 As Group = TryCast(y, Group)
        Return
        String.Compare(x1.Records(0).GetValue(sortColumnDescriptorName).ToString(), 
                      y1.Records(0).GetValue(sortColumnDescriptorName).ToString())
    'End Region
```

**Explanation of the Code:**
- The `CustomGroupSortOrderComparer` class implements the `IComparer` interface, allowing custom sorting of groups in the `GridGroupingControl`.
- The `Compare` method determines the order of groups based on the value of the specified column descriptor (`sortColumnDescriptorName`).

#### Handling the QueryValue Event

The `QueryValue` event is used to manage the grid's behavior when custom sorting is applied. Here's the implementation:

```vb
void gridGroupingControl1_QueryValue(Object sender, FieldValueEventArgs e)
    'Code...
    If g = e.Record.ParentGroup Then
        Dim list As New ArrayList(table.Values.Count)
        list.AddRange(table.Values)
        list.Sort()
        If flag1 OrElse flag2 Then
            If flag1 Then
                index = list.IndexOf(table(e.Record.GetValue(e.TableDescriptor.GroupedColumns(0).Name))) - 1
            ElseIf flag2 Then
                index = list.IndexOf(table(e.Record.GetValue(e.TableDescriptor.GroupedColumns(0).Name))) + 1
            End If
            If index < 0 OrElse index >= list.Count Then
                MessageBox.Show("Cannot go further!")
            End If
        'Code...
        End If
    'If you click the Move Up button the index of the current record is decreased using the below code.
        index = list.IndexOf(table(e.Record.GetValue(e.TableDescriptor.GroupedColumns(0).
```

**Explanation of the Event Handling:**
- The `QueryValue` event is triggered when the grid needs to sort values or determine the order of records.
- The `list` variable stores the values of the grouped column, which are then sorted.
- Based on `flag1` and `flag2`, the code determines whether to move the record up or down in the sorted list.
- If the index calculation results in an invalid position, a message box indicates that the move is not possible.

---

### API Reference

#### Class: `CustomGroupSortOrderComparer`
- **Namespace:** Syncfusion.Windows.Forms.Grid
- **Members:**
    - **sortColumnDescriptorName:** String
        - Specifies the name of the column descriptor used for sorting.
    - **Compare:** Method
        - Compares two groups (`x` and `y`) based on the value of the specified column descriptor.

---

### Code Examples

#### VB Example

```vb
' Define the custom comparer
Dim customComparer As New CustomGroupSortOrderComparer("NameColumn")

' Set the comparer for sorting groups
gridGroupingControl1.SortedGroupLevel.Comparer = customComparer
```

---

### Cross References
- See also: `GridGroupingControl`, `IComparer`, `QueryValue` event.

<!-- tags: [syncfusion, grid, windows forms, CustomGroupSortOrderComparer, IGroupSortOrderComparer, QueryValue event] keywords: [gridGroupingControl, sorting, groups, comparer, customization] -->
```