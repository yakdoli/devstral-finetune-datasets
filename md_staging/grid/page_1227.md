```html
<!-- 
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_1227.jpeg
document_name: grid
page_number: 1227
page_id: grid#page_1227
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T05:40:10Z
fidelity: lossless
-->

# Essential Grid for Windows Forms

## Overview

- Demonstrates how to show a context menu in the center of the current cell or selected cells regardless of the mouse click position.
- Involves handling the Grid's MouseDown event to calculate the center location of cells or ranges and show the context menu there.
- Provides code snippets in both C# and VB.NET to implement this functionality.

## Content

### 5.1.30 How to Show a ContextMenu in the Center of CurrentCell or Selected Cells Irrespective of the Mouse Click

To achieve this, the Grid's MouseDown event should be handled. Within the event handler, the center location of the current cell or the selected range is calculated, and the context menu is displayed after moving the cursor to the center point. Below is the code snippet.

#### C#

```csharp
private void gridControl1_MouseDown(object sender, MouseEventArgs e)
{
    if (e.Button == MouseButtons.Right)
    {
        GridCurrentCell cc = this.gridControl1.CurrentCell;
        Point pt = new Point(e.X, e.Y); // to retrieve mouse position
        if (this.gridControl1.Selections.Ranges.Count > 0) // Selecting more than one Cell
        {
            pt = GridUtil.CenterPoint(this.gridControl1.RangeInfoToRectangle(this.gridControl1.Selections.Ranges.ActiveRange));
            Cursor.Position = this.gridControl1.PointToScreen(pt);
        }
        else if (cc.HasCurrentCell) // Single Cell
        {
            pt = GridUtil.CenterPoint(this.gridControl1.RangeInfoToRectangle(cc.RangeInfo));
            Cursor.Position = this.gridControl1.PointToScreen(pt);
        }
        this.contextMenu1.Show(this.gridControl1, pt); // to Show ContextMenu
    }
}
```

#### VB.NET

```vb
Private Sub gridControl1_MouseDown(ByVal sender As Object, ByVal e As MouseEventArgs)
    If e.Button = MouseButtons.Right Then
        Dim cc As GridCurrentCell = Me.gridControl1.CurrentCell
        Dim pt As Point = New Point(e.X, e.Y) 'To get the mouse position
        If Me.gridControl1.Selections.Ranges.Count > 0 Then
            pt = GridUtil.CenterPoint(Me.gridControl1.RangeInfoToRectangle(Me.gridControl1.Selections.Ranges.ActiveRange))
            Cursor.Position = Me.gridControl1.PointToScreen(pt)
        ElseIf cc.HasCurrentCell Then
            pt = GridUtil.CenterPoint(Me.gridControl1.RangeInfoToRectangle(cc.RangeInfo))
            Cursor.Position = Me.gridControl1.PointToScreen(pt)
        End If
        Me.contextMenu1.Show(Me.gridControl1, pt) ' to Show ContextMenu
    End If
End Sub
```

## Tags and Keywords
<!-- tags: [grid, contextmenu, mouseevent, windowsforms] keywords: [gridcontrol, mousedown, gridutil, centerpoint, rangeinfotorectangle, pointtoscreen] -->
```