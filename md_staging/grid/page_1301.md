```html
<!--
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en
source_filename: page_1301.jpeg
document_name: grid
page_number: 1301
page_id: grid#page_1301
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T05:44:50Z
fidelity: lossless
-->

# Essential Grid for Windows Forms

```csharp
(GridTableCellStyleInfo) this.StyleInfo;
    GridTableCellStyleInfo tableCellIdentity = tableStyleInfo.TableCellIdentity;
    Model.Select_WithoutCustom(tableCellIdentity, this.ListBoxPart.SelectedIndex);

    // Don't call base class - ignore.
    SetTextBoxText(GetFilterBarText(styleInfo), false);
}
```

### [VB.NET]

```vb
Public Class GridTableFilterBarCellModel1: Inherits GridTableFilterBarCellModel

    Public Sub New(ByVal gm As Syncfusion.Windows.Forms.Grid.GridModel)
        MyBase.New(gm)
    End Sub

    ' Override FillWithChoices to remove 'Custom' option from the list.
    Public Overrides Sub FillWithChoices(ByVal listBox As ListBox, ByVal style As GridStyleInfo, <System.Runtime.CompilerServices.Out()> ByRef exclusive As Boolean)

        exclusive = True
        Dim tableStyleInfo As GridTableCellStyleInfo = CType(style, GridTableCellStyleInfo)
        Dim items As Object() = CType(GetFilterBarChoices(tableStyleInfo.TableCellIdentity), Object())
        listBox.Items.Clear()
        If Not items Is Nothing Then

            listBox.Items.Add(SelectAllText)
            For Each item As Object In items

                If TypeOf item Is DBNull Then
                    listBox.Items.Add(SelectEmptyText)
                ElseIf Not item Is Nothing Then
                    listBox.Items.Add(style.GetFormattedText(item))
                End If
            Next item
        End If
    End Sub
End Class
```

## Overview
- Demonstrates customizing the `GridTableFilterBarCellModel` to remove the 'Custom' option from the filter bar list.
- Provides code examples in both C# and VB.NET for overriding the `FillWithChoices` method.
- Shows how to selectively populate the filter bar list based on specific conditions.

## Content

This section explores how to customize the `GridTableFilterBarCellModel` in Syncfusion WinForms to control the behavior of the filter bar in a grid. The example demonstrates how to override the `FillWithChoices` method to modify the options available in the filter bar. By removing the 'Custom' option, the user experience can be tailored to specific needs.

### Implementation Details

1. **Creating a Custom Model**:
   - The class `GridTableFilterBarCellModel1` inherits from `GridTableFilterBarCellModel`.
   - The constructor initializes the base class with the grid model.

2. **Overriding `FillWithChoices`**:
   - The `FillWithChoices` method is overridden to customize the list of choices in the filter bar.
   - The `exclusive` parameter is set to `True` to ensure custom behavior.
   - The `tableStyleInfo` is cast from the `GridStyleInfo` to `GridTableCellStyleInfo` to access specific properties.
   - The `GetFilterBarChoices` method retrieves the list of choices based on the `tableCellIdentity`.

3. **Handling Special Cases**:
   - The empty (`DBNull`) and `Nothing` cases are handled separately to ensure proper display in the filter bar.
   - The `SelectAllText` and `SelectEmptyText` values are added to the list box to provide default selection options.

4. **Populating the List**:
   - The `listBox` is cleared before adding the new items.
   - Each item is processed to add its formatted text to the list box.

### Sample Code

The provided code examples illustrate how to implement these customizations in both C# and VB.NET. The logic ensures that only relevant and pre-defined options are displayed in the filter bar, enhancing the user interface.

## API Reference

- **Namespace**: Syncfusion.Windows.Forms.Grid
- **Class**: GridTableFilterBarCellModel
- **Methods**:
  - `FillWithChoices`: Customizes the list of choices displayed in the filter bar.
  - `GetFilterBarChoices`: Retrieves the available choices based on the table cell identity.

## Code Examples

### C#

```csharp
(GridTableCellStyleInfo) this.StyleInfo;
    GridTableCellStyleInfo tableCellIdentity = tableStyleInfo.TableCellIdentity;
    Model.Select_WithoutCustom(tableCellIdentity, this.ListBoxPart.SelectedIndex);

    // Don't call base class - ignore.
    SetTextBoxText(GetFilterBarText(styleInfo), false);
}
```

### VB.NET

```vb
    Public Overrides Sub FillWithChoices(ByVal listBox As ListBox, ByVal style As GridStyleInfo, <System.Runtime.CompilerServices.Out()> ByRef exclusive As Boolean)

        exclusive = True
        Dim tableStyleInfo As GridTableCellStyleInfo = CType(style, GridTableCellStyleInfo)
        Dim items As Object() = CType(GetFilterBarChoices(tableStyleInfo.TableCellIdentity), Object())
        listBox.Items.Clear()
        If Not items Is Nothing Then

            listBox.Items.Add(SelectAllText)
            For Each item As Object In items

                If TypeOf item Is DBNull Then
                    listBox.Items.Add(SelectEmptyText)
                ElseIf Not item Is Nothing Then
                    listBox.Items.Add(style.GetFormattedText(item))
                End If
            Next item
        End If
    End Sub
```

## Page-level Navigation/TOC (if applicable)

- [essential-grid-for-windows-forms]
  - Customizing GridTableFilterBarCellModel
    - Overriding FillWithChoices
    - Handling Special Cases
    - Populating the List

## Cross References

- **Related Controls**:
  - `GridTableFilterBarCellModel`
  - `GridStyleInfo`
  - `GridTableCellStyleInfo`

## RAG Annotations

<!-- tags: [syncfusion, winforms, grid, filterbar, custommodel, override, fillwithchoices] keywords: [GridTableCellStyleInfo, GetFilterBarChoices, SelectAllText, SelectEmptyText, FilterBar, CustomModel] -->
```