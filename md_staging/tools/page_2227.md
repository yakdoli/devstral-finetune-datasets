```html
<!--
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_2227.jpeg
document_name: tools
page_number: 2227
page_id: tools#page_2227
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T09:44:36Z
fidelity: lossless
-->

# Essential Tools for Windows Forms

```csharp
Rectangle bounds = this.treeViewAdv2.SelectedNode.Bounds;
this.listBox1.Items.Clear();
try 
{
    this.listBox1.Items.AddRange(Directory.GetFiles(this.treeViewAdv2
    .SelectedNode.GetPath("\\")));
}
catch {}        // Exception will be thrown in the user renamed the dirs and then selects them. Lose the exception.
}
```

### [VB.NET]

```vb
Me.treeViewAdv1.LoadOnDemand = True
Me.treeViewAdv1.AddSeparatorAtEnd = True

Private Sub treeViewAdv2_BeforeExpand(ByVal sender As Object, ByVal e As Syncfusion.Windows.Forms.Tools.TreeViewAdvCancelableNodeEventArgs) Handles treeViewAdv2.BeforeExpand
    'Checking Whether the Node has been expanded atleast once
    If e.Node.ExpandedOnce Then
        Return
    End If
    'Retrieves the path for the specific node.
    'Get the Path of the node and AddSeparatorAtEnd Property set to true
    Dim path As String = e.Node.GetPath("\")
    'Get an Array of Directories from the current directory path
    Dim dirs As ArrayList = New ArrayList(Directory.GetDirectories(path))
    'Add the Directories as a node in TreeViewAdv
    Dim i As Integer = 0

    Do While i < dirs.Count
        Dim dir As String = CStr(dirs(i))
        Dim lastIndex As Integer = dir.LastIndexOf("\") + 1
        Dim node As TreeNodeAdv = New TreeNodeAdv(dir.Substring(lastIndex))
        e.Node.Nodes.Add(node)
        i += 1
    Loop
End Sub

Private Sub treeViewAdv2_AfterSelect(ByVal sender As Object, ByVal e As EventArgs) Handles treeViewAdv2.AfterSelect
```

## Content

The code snippets provided demonstrate how to manage a tree view control in a Windows Forms application using both C# and VB.NET. The primary functionality includes:

- **LoadOnDemand**: Enables lazy loading of nodes when expanding them, improving performance.
- **AddSeparatorAtEnd**: Adds a separator at the end of the node list for better visual separation.
- **Handle BeforeExpand Event**: Checks if the node has already been expanded at least once to prevent redundant operations.
- **Retrieve Directory Path**: Fetches the path of the selected node to list its subdirectories.
- **Add Directories to TreeView**: Populates the tree view with subdirectories, ensuring only the visible part of the path is shown as the node text.
- **Handle AfterSelect Event**: Manages actions to take when a node is selected.

### Key Features Highlighted in the Code:

1. **Performance Optimization**: By using `LoadOnDemand`, only nodes that are expanded are loaded, reducing memory consumption and improving responsiveness.
2. **User Interface Enhancements**: The `AddSeparatorAtEnd` property enhances the visual separation between nodes, making the tree structure more intuitive.
3. **Error Handling**: The code includes a `try-catch` block to handle exceptions gracefully, ensuring the application remains stable even if the user renames directories.
4. **Dynamic Node Population**: The tree view is dynamically populated with subdirectories, ensuring that the latest directory structure is always displayed.

## API Reference

- **Namespace**: Syncfusion.Windows.Forms.Tools
- **Classes**: TreeNodeAdv, TreeViewAdv
- **Methods**:
  - **GetPath(string path)**: Retrieves the path for the specific node.
  - **GetDirectories(string path)**: Retrieves an array of directories from the specified path.
  - **SelectedNode.Bounds**: Provides the bounds of the selected node in the tree view.
- **Properties**:
  - **LoadOnDemand**: Boolean property to enable lazy loading of nodes.
  - **AddSeparatorAtEnd**: Boolean property to add separators at the end of the node list.

## Code Examples

The following code examples demonstrate the implementation of the tree view control in both C# and VB.NET, showcasing how to manage node expansion and selection dynamically.

### C# Example

```csharp
Rectangle bounds = this.treeViewAdv2.SelectedNode.Bounds;
this.listBox1.Items.Clear();
try 
{
    this.listBox1.Items.AddRange(Directory.GetFiles(this.treeViewAdv2
    .SelectedNode.GetPath("\\")));
}
catch {}        // Exception handling logic omitted
```

### VB.NET Example

```vb
Me.treeViewAdv1.LoadOnDemand = True
Me.treeViewAdv1.AddSeparatorAtEnd = True

Private Sub treeViewAdv2_BeforeExpand(ByVal sender As Object, ByVal e As Syncfusion.Windows.Forms.Tools.TreeViewAdvCancelableNodeEventArgs) Handles treeViewAdv2.BeforeExpand
    ' Checking Whether the Node has been expanded atleast once
    If e.Node.ExpandedOnce Then
        Return
    End If
    ' Retrieves the path for the specific node.
    Dim path As String = e.Node.GetPath("\")
    ' Get an Array of Directories from the current directory path
    Dim dirs As ArrayList = New ArrayList(Directory.GetDirectories(path))
    ' Add the Directories as a node in TreeViewAdv
    Dim i As Integer = 0

    Do While i < dirs.Count
        Dim dir As String = CStr(dirs(i))
        Dim lastIndex As Integer = dir.LastIndexOf("\") + 1
        Dim node As TreeNodeAdv = New TreeNodeAdv(dir.Substring(lastIndex))
        e.Node.Nodes.Add(node)
        i += 1
    Loop
End Sub

Private Sub treeViewAdv2_AfterSelect(ByVal sender As Object, ByVal e As EventArgs) Handles treeViewAdv2.AfterSelect
```

## See also

- [TreeViewAdv Control Overview](#)
- [LoadOnDemand Property](#)
- [AddSeparatorAtEnd Property](#)
- [BeforeExpand Event](#)
- [AfterSelect Event](#)

<!-- tags: Windows Forms, TreeViewAdv Control, LoadOnDemand, AddSeparatorAtEnd, node expansion, dynamic node population keywords: tree view control, Windows Forms, lazy loading, node selection, directory structure, error handling -->
```