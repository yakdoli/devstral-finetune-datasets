```html
<!--
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_1248.jpeg
document_name: tools
page_number: 1248
page_id: tools#page_1248
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T08:38:06Z
fidelity: lossless
-->

## Overview
- **Key Feature**: Managing ParentBarItem's events in Windows Forms.
- **Use Case**: Controlling the behavior of a context menu before it is displayed.
- **Implementation**: Demonstrating the use of the `BeforePopup` event in both C# and VB.NET.

## Content

### Handling the BeforePopup Event

To manage the behavior of a context menu before it is displayed, you can attach a `BeforePopup` event handler to a `ParentBarItem`. This event provides an opportunity to check conditions and cancel the popup if necessary.

#### Example Code

**C#**
```csharp
this.parentBarItem1.BeforePopup += new
CancelEventHandler(PopupMenu_BeforePopup);

private void PopupMenu_BeforePopup(object sender, CancelEventArgs arg)
{
    // Check for a condition and cancel if necessary
    arg.Cancel = true;
}
```

**VB.NET**
```vb
Private Sub PopupMenu_BeforePopup(ByVal sender As Object, ByVal arg As CancelEventArgs)
    ' Check for a condition and cancel if necessary
    arg.Cancel = True
End Sub
```

#### Explanation
- The `BeforePopup` event is triggered before the context menu is displayed.
- The `CancelEventArgs` argument allows you to cancel the popup by setting its `Cancel` property to `true`.
- This is useful for dynamically deciding whether to display the menu based on certain conditions.

### Determining the Source Control of a Context Menu

To identify the control on which the context menu was shown, you can use the `SourceControl` property of the `PopupMenu`.

#### Example Code

**C#**
```csharp
// The PopupMenu's SourceControl specifies its target control
Control srcControl = this.popupMenu1.SourceControl;
```

**VB.NET**
```vb
' The PopupMenu's SourceControl specifies its target control
Dim srcControl As Control = Me.popupMenu1.SourceControl
```

#### Explanation
- The `SourceControl` property of the `PopupMenu` indicates the control that invoked the context menu.
- This property is useful for implementing context-sensitive menus that vary based on the control being manipulated.

### ComboBoxBarItems

This section focuses on the use of `ComboBoxBarItems` in Syncfusion WinForms.

#### Topics Covered
- Managing and configuring `ComboBoxBarItems`.
- Handling events and setting up bindings.
- Customizing the appearance and behavior of `ComboBoxBarItems`.

#### Implementation Details
The `ComboBoxBarItem` control allows for enhanced functionality by combining the features of a combo box with those of a toolbar item. It provides options for dropdown lists, custom rendering, and event handling.

## See Also

- **Events of ParentBarItem**
- **3.7.5.1.5 How to determine on which control a context menu was shown**

We can identify the control on which the context menu was shown by using the below code.

### RELATED SECTION: Combining Menu and Toolbar Functionality

This section delves into the integration of menus and toolbars in Syncfusion WinForms applications.

#### Goals
- Customizing the menu and toolbar experience for enhanced user interaction.
- Handling events and conditions dynamically with context-sensitive menus.

#### Implementation Steps
- Attach appropriate event handlers to manage behavior before a menu is displayed.
- Use the `SourceControl` property to determine the context for context-sensitive menus.

## API Reference

### Properties
- **SourceControl**: Gets the source control that invoked the menu.
- **BeforePopup**: Triggered before the menu is displayed, allowing for condition checks.

### Methods
- **ShowPopup**: Displays the menu at a specified location.
- **CancelPopup**: Cancels the display of the menu.

### Events
- **BeforePopup**: Event raised before the menu is displayed.
- **Popup**: Event raised after the menu is displayed.

## Code Examples

The complete implementation involves attaching event handlers and managing conditions dynamically. Below is a combined example.

### Example

**C#**
```csharp
// Attach event handler
this.parentBarItem1.BeforePopup += new CancelEventHandler(PopupMenu_BeforePopup);

private void PopupMenu_BeforePopup(object sender, CancelEventArgs arg)
{
    // Check condition
    if (someCondition)
    {
        arg.Cancel = true;
    }
}

// Get source control
Control srcControl = this.popupMenu1.SourceControl;
```

**VB.NET**
```vb
' Attach event handler
Private Sub PopupMenu_BeforePopup(ByVal sender As Object, ByVal arg As CancelEventArgs)
    ' Check condition
    If someCondition Then
        arg.Cancel = True
    End If
End Sub

' Get source control
Dim srcControl As Control = Me.popupMenu1.SourceControl
```

## Cross References

- **Events of ParentBarItem**
- **3.7.5.1.5 How to determine on which control a context menu was shown**
- **3.7.5.2 ComboBoxBarItems**

### RELATED SECTION: Combining Menu and Toolbar Functionality

This section covers the process of combining menus and toolbars for a cohesive user interface. It includes examples and best practices for handling complex scenarios.

## RAG Annotations

<!-- tags: tools, menu, context menu, comboboxbaritems, windows forms, syncfusion winforms, version 11.4.0.26 -->
<!-- keywords: beforepopup, sourcecontrol, cancel, context menu, parentbaritem, comboboxbaritems, menu, toolbar, event handling, windows forms -->
```