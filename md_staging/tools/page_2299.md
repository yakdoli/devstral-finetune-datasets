```html
<!--
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_2299.jpeg
document_name: tools
page_number: 2299
page_id: tools#page_2299
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T09:50:08Z
fidelity: lossless
-->

# Essential Tools for Windows Forms

## Overview
- Demonstrates using the `TreeViewAdvDragHighlightTracker` to enable drag-and-drop functionality with selection highlighting in a `TreeViewAdv` control.
- Includes specifications for allowed drop positions and sensitivity of edge detection during drag operations.
- Implementation details for both C# and VB.NET code are provided for handling drag-and-drop events and highlight behavior.

## Content

### Drag-and-Drop in TreeViewAdv

The `TreeViewAdvDragHighlightTracker` provides enhanced drag-and-drop capabilities in the `TreeViewAdv` control. It allows developers to specify how drag operations affect node selection, highlight behavior, and drop positions.

#### C#

```csharp
e.ShowSelectionHighlight =
    // Only if the source node is droppable
    this.CanDrop(this.currentSourceNode, e.HighlightNode)
    // and droppable ON the node (not beside it)
    && e.NewDropPosition == TreeViewDropPositions.OnNode;
}
}
```

#### VB.NET

```vb
' Declaration
Private treeViewDragHighlightTracker As TreeViewAdvDragHighlightTracker = Nothing
' Initialization
Me.treeViewDragHighlightTracker = New TreeViewAdvDragHighlightTracker(Me.treeViewAdv1)

' QueryAllowedPositionsForNode
AddHandler
Me.treeViewDragHighlightTracker.QueryAllowedPositionsForNode, AddressOf TreeDragDrop_QueryAllowedPositionsForNode
' Specify the allowed drop positions for the specified highlight node.
Private Sub TreeDragDrop_QueryAllowedPositionsForNode(ByVal sender As Object, ByVal e As QueryAllowedPositionsEventArgs)
    If (Not Me.IsContinentNode(e.HighlightNode)) Then
        ' If this a country node, only allow drop above or below it.
        If Not e.HighlightNode Is Me.currentSourceNode Then
            e.AllowedPositions = TreeViewDropPositions.AboveNode Or
                                 TreeViewDropPositions.BelowNode
        Else
            ' Cannot drop beside itself
            e.AllowedPositions = TreeViewDropPositions.None
        End If
        Me.treeViewDragHighlightTracker.EdgeSensitivity = e.HighlightNode.Bounds.Height / 2
        e.ShowSelectionHighlight = False
    Else
        ' If this is a continent node allow all drop positions (default behavior).
        Me.treeViewDragHighlightTracker.EdgeSensitivity = e.HighlightNode.Bounds.Height / 4
        ' Only if the source node is droppable
        ' and droppable ON the node (not beside it)
        e.ShowSelectionHighlight = Me.CanDrop(Me.currentSourceNode, e.HighlightNode)
                                    AndAlso e.NewDropPosition = TreeViewDropPositions.OnNode
    End If
End Sub
```

## Tags and Keywords
<!-- tags: [TreeViewAdv, Drag-and-Drop, DragHighlightTracker, WinForms, Syncfusion] keywords: [TreeViewAdvDragHighlightTracker, TreeViewDropPositions, EdgeSensitivity, QueryAllowedPositionsForNode, DragDrop, ShowSelectionHighlight] -->
```