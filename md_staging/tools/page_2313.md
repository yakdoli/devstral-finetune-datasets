```html
<!--
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_2313.jpeg
document_name: tools
page_number: 2313
page_id: tools#page_2313
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T09:51:10Z
fidelity: lossless
-->

## Essential Tools for Windows Forms

### Overview
- Demonstrates how to implement Undo/Redo functionality in a tree view control using the HistoryManager class.
- Explains the use of the HistoryManager for handling node operations such as deletion, addition, text editing, and drag/drop.
- Provides examples in both C# and VB.NET to enable Undo/Redo actions in the tree view.

### Content

#### Using HistoryManager for Undo/Redo

##### C#

```csharp
/*The user should get the HistoryManager to use and then the HistoryEnabled property
should be set to true. The HistoryManager plays the role in the Undo/Redo actions.*/

1. Deleting a node
2. Adding a node
3. Editing node's Text
4. Drag/drop of a node*/

private void barItem1_Click(object sender, System.EventArgs e)
{
    if (this.treeViewAdv1.HistoryManager.CanUndo == true)
    {
        this.treeViewAdv1.HistoryManager.Undo();
    }
}

private void barItem2_Click(object sender, System.EventArgs e)
{
    if (this.treeViewAdv1.HistoryManager.CanRedo == true)
    {
        this.treeViewAdv1.HistoryManager.Redo();
    }
}
```

##### VB.NET
```vb
'The user should get the HistoryManager to use and then the HistoryEnabled property
'should be set to true. The HistoryManager plays the role in the Undo/Redo actions .

'1. Deleting a node
'2. Adding a node
'3. Editing node's Text
'4. Drag/drop of a node
Private Sub barItem1_Click(ByVal sender As Object, ByVal e As System.EventArgs)
```

## API Reference

### Methods
- **HistoryManager.Undo()**: Reverses the last performed action if `CanUndo` is true.
- **HistoryManager.Redo()**: Restores the previously undone action if `CanRedo` is true.

### Properties
- **HistoryManager.CanUndo**: Gets a value indicating whether reverse actions can be performed.
- **HistoryManager.CanRedo**: Gets a value indicating whether previously reversed actions can be restored.

### Events
- **HistoryManager.UndoRedoComplete**: Occurs when all undo or redo operations are completed.

## Code Examples

#### Example: Implementing Undo/Redo in C#

```csharp
using Syncfusion.Windows.Forms.Tools;

// Enable Undo/Redo functionality
treeViewAdv1.HistoryManager.HistoryEnabled = true;

// Event handler for Undo action
private void barItem1_Click(object sender, System.EventArgs e)
{
    if (treeViewAdv1.HistoryManager.CanUndo)
    {
        treeViewAdv1.HistoryManager.Undo();
    }
}

// Event handler for Redo action
private void barItem2_Click(object sender, System.EventArgs e)
{
    if (treeViewAdv1.HistoryManager.CanRedo)
    {
        treeViewAdv1.HistoryManager.Redo();
    }
}
```

#### Example: Implementing Undo/Redo in VB.NET

```vb
Imports Syncfusion.Windows.Forms.Tools

' Enable Undo/Redo functionality
treeViewAdv1.HistoryManager.HistoryEnabled = True

' Event handler for Undo action
Private Sub barItem1_Click(ByVal sender As Object, ByVal e As System.EventArgs)
    If treeViewAdv1.HistoryManager.CanUndo Then
        treeViewAdv1.HistoryManager.Undo()
    End If
End Sub

' Event handler for Redo action
Private Sub barItem2_Click(ByVal sender As Object, ByVal e As System.EventArgs)
    If treeViewAdv1.HistoryManager.CanRedo Then
        treeViewAdv1.HistoryManager.Redo()
    End If
End Sub
```

### Cross References

- See also: `HistoryManager`, `TreeNode`, `TreeAdv`.

#### Tags and Keywords
<!-- tags: Windows Forms, TreeView, HistoryManager, Undo, Redo, SyncfusionWinForms, Version11.4.0.26 keywords: TreeViewUndo, TreeViewRedo, HistoryEnabled, CanUndo, CanRedo -->
```