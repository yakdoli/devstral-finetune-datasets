```html
<!-- 
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_2300.jpeg
document_name: tools
page_number: 2300
page_id: tools#page_2300
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T09:49:02Z
fidelity: lossless
-->

# Essential Tools for Windows Forms

```csharp
End If
End Sub
```

## 3.21.5.16 How to prevent the expansion of the collapsed nodes when it is been double clicked

BeforeExpand event should be handled to prevent the expansion of the collapsed nodes when it is double-clicked.

### [C#]

```csharp
//The following code will ensure that the node will expand only when clicked on the Node's Expandable
//button ( that is, the "+" box on the left of the node) and not when clicked on the TreeNodeAdv's text.

private void treeViewAdv1_BeforeExpand(object sender,
Syncfusion.Windows.Forms.Tools.TreeViewAdvCancelableNodeEventArgs e)
{
    Point p = this.treeViewAdv1.PointToClient(Control.MousePosition);
    TreeNodeAdv node = this.treeViewAdv1.GetNodeAtPoint(p, true);
    if (node != null)
    {
        if (node.TextBounds.Contains(p))
        {
            e.Cancel = true;
        }
    }
}
```

### [VB.NET]

```vb
'The following code will ensure that the node will expand only when clicked on the Node's Expandable
'button ( that is, the "+" box on the left of the node) and not when clicked on the TreeNodeAdv's text.

Private Sub treeViewAdv1_BeforeExpand(ByVal sender As Object, ByVal e As Syncfusion.Windows.Forms.Tools.TreeViewAdvCancelableNodeEventArgs)
    Dim p As Point =
    Me.treeViewAdv1.PointToClient(Control.MousePosition)
    Dim node As TreeNodeAdv = Me.treeViewAdv1.GetNodeAtPoint(p, True)
End Sub
```

## RAG Annotations
<!-- tags: TreeViewAdv, NodeExpansion, DoubleClick, EventHandling, C#, VB.NET, Syncfusion Windows Forms keywords: Essential Tools, Prevent Expansion, Collapsed Nodes, BeforeExpand Event, C#, VB.NET, Double-Click Handling --> 
```