```html
<!-- 
source: image
domain: syncfusion-sdk
task: pdf-ocr-to-markdown
language: en (keep original; do not translate)
source_filename: page_1457.jpeg
document_name: tools
page_number: 1457
page_id: tools#page_1457
product: Syncfusion Winforms
version: 11.4.0.26
timestamp: 2025-08-09T08:51:55Z
fidelity: lossless
-->

# Essential Tools for Windows Forms

The following example handles the `ProvideBrushEventHandler` event of a `XPToolBarBox` and performs custom background drawing.

```csharp
[C#]

private void taskBarBox_ProvideHeaderBackgroundBrush(object sender, Syncfusion.Windows.Forms.Tools.ProvideBrushEventArgs args)
{
    // Custom draw the background only when XP Themes is not available.
    // Using Syncfusion.Windows.Forms namespace.
    if (!XPThemes.IsThemedOS && !XPThemes.IsThemeActive && !this.xpTaskBar1.ThemesEnabled)
    {
        if (args.Bounds.Width != 0 && args.Bounds.Height != 0)
        {
            // Blend settings
            float[] relativeIntensities = { 0.0f, 0.0f, 1.0f };
            float[] relativePositions = { 0.0F, 0.5f, 1.0F };
            Blend blend = new Blend();
            blend.Factors = relativeIntensities;
            blend.Positions = relativePositions;
            XPToolBarItem box = sender as XPToolBarItem;
            // Header back brush.
            LinearGradientBrush lgBrush = new LinearGradientBrush(args.Bounds, Color.White, box.HeaderBackColor, 0, true);
            lgBrush.Blend = blend;
            args.Brush = lgBrush;
        }
    }
}
```

```vbnet
[VB.NET]

Private Sub taskMenuBox_ProvideHeaderBackgroundBrush(sender As Object, args As Syncfusion.Windows.Forms.Tools.ProvideBrushEventArgs)
    ' Custom draw the background only when XP Themes is not available.
    ' Using Syncfusion.Windows.Forms namespace.
    If Not XPThemes.IsThemedOS And Not XPThemes.IsThemeActive And Not Me.xpTaskBar1.ThemesEnabled Then
        If args.Bounds.Width <> 0 And args.Bounds.Height <> 0 Then
            ' Blend settings.
            Dim relativeIntensities As Single() = {0.0F, 0.0F, 1.0F}
            Dim relativePositions As Single() = {0.0F, 0.5F, 1.0F}
            Dim blend As New Blend()
            blend.Factors = relativeIntensities
        End If
    End If
End Sub
```

## API Reference

- **Namespace**: Syncfusion.Windows.Forms.Tools
- **Class**: XPToolBarBox
- **Event**: ProvideBrushEventHandler

### Parameters
- **sender**: The source of the event.
- **args**: An instance of `ProvideBrushEventArgs` containing event data.

### Methods
- **XPThemes.IsThemedOS**: Checks if the operating system is using XP Themes.
- **XPThemes.IsThemeActive**: Checks if themes are active on the system.
- **XPToolbarItem.HeaderBackColor**: Sets the background color of the toolbar item's header.

## Code Examples

### C#

```csharp
private void taskBarBox_ProvideHeaderBackgroundBrush(object sender, Syncfusion.Windows.Forms.Tools.ProvideBrushEventArgs args)
{
    if (!XPThemes.IsThemedOS && !XPThemes.IsThemeActive && !this.xpTaskBar1.ThemesEnabled)
    {
        if (args.Bounds.Width != 0 && args.Bounds.Height != 0)
        {
            float[] relativeIntensities = { 0.0f, 0.0f, 1.0f };
            float[] relativePositions = { 0.0F, 0.5f, 1.0F };
            Blend blend = new Blend();
            blend.Factors = relativeIntensities;
            blend.Positions = relativePositions;
            XPToolBarItem box = sender as XPToolBarItem;
            LinearGradientBrush lgBrush = new LinearGradientBrush(args.Bounds, Color.White, box.HeaderBackColor, 0, true);
            lgBrush.Blend = blend;
            args.Brush = lgBrush;
        }
    }
}
```

### VB.NET

```vbnet
Private Sub taskMenuBox_ProvideHeaderBackgroundBrush(sender As Object, args As Syncfusion.Windows.Forms.Tools.ProvideBrushEventArgs)
    If Not XPThemes.IsThemedOS And Not XPThemes.IsThemeActive And Not Me.xpTaskBar1.ThemesEnabled Then
        If args.Bounds.Width <> 0 And args.Bounds.Height <> 0 Then
            Dim relativeIntensities As Single() = {0.0F, 0.0F, 1.0F}
            Dim relativePositions As Single() = {0.0F, 0.5F, 1.0F}
            Dim blend As New Blend()
            blend.Factors = relativeIntensities
            Dim lgBrush As New LinearGradientBrush(args.Bounds, Color.White, DirectCast(sender, XPToolBarItem).HeaderBackColor, 0, True)
            lgBrush.Blend = blend
            args.Brush = lgBrush
        End If
    End If
End Sub
```

<!-- tags: [ Syncfusion Winforms, XPToolbarBox, ProvideBrushEventHandler, XPThemes, Custom Background Drawing] keywords: [ ProvideBrushEventArgs, XPThemes, HeaderBackColor, Blend, LinearGradientBrush, XPToolBarBox, custom drawing, XP themes] -->
```